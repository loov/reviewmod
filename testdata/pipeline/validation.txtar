pass: validation
package: ./testdata/testpkg

-- want.txt --
== prompt 0 ==
You are analyzing a Go function to create a summary of its behavior.


## Function: Add
Package: testpkg
Signature: func Addfunc(a, b int) int
Documentation: Add adds two numbers.


```go
{
	return a + b
}
```

Analyze this function and respond with JSON in this exact format:
{
  "purpose": "One sentence describing what this function does",
  "behavior": "How it behaves - side effects, return conditions, error cases",
  "invariants": ["preconditions", "postconditions", "guarantees"],
  "security": ["security-relevant properties for callers to know"]
}

Be precise and concise. Focus on what callers need to know.


== prompt 1 ==
You are reviewing Go code for input validation issues.


## Function: Add
Package: testpkg
Signature: func Addfunc(a, b int) int
Documentation: Add adds two numbers.


```go
{
	return a + b
}
```

## Function Summary
Purpose: test purpose
Behavior: test behavior

## Input Validation Review Checklist
Look for:
- Missing nil checks before dereferencing pointers
- Missing length checks before slice/array access
- Missing bounds validation on numeric inputs
- Assumptions about string format without validation
- Missing empty string checks
- Integer overflow potential on arithmetic
- Missing validation at API boundaries
- Type assertions without ok check
- Map access without existence check when needed
- Slice capacity assumptions
- Missing validation of external data (JSON, user input)
- Trusting data from channels/callbacks without validation

Only report actual validation issues. If no issues found, return {"issues": []}.

Respond with JSON. Example:
{"issues": [{"function": "ParseConfig", "line": 15, "severity": "critical", "message": "SQL injection via string concatenation", "suggestion": "Use parameterized query"}]}

If no issues found, return {"issues": []}.
