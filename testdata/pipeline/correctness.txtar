pass: correctness
package: ./testdata/testpkg

-- want.txt --
== prompt 0 ==
You are analyzing a Go function to create a summary of its behavior.


## Function: Add
Package: testpkg

```go
// Add adds two numbers.
//
// TODO: should this handle overflow?
func Add(a, b int) int {
	// This adds two numbers together.
	return a + b
}
```

Analyze this function and respond with JSON in this exact format:
{
  "purpose": "One sentence describing what this function does",
  "behavior": "How it behaves - side effects, return conditions, error cases",
  "invariants": ["preconditions", "postconditions", "guarantees"],
  "security": ["security-relevant properties for callers to know"]
}

Be precise and concise. Focus on what callers need to know.


== prompt 1 ==
You are reviewing Go code for correctness issues.


## Function: Add
Package: testpkg

```go
// Add adds two numbers.
//
// TODO: should this handle overflow?
func Add(a, b int) int {
	// This adds two numbers together.
	return a + b
}
```

## Function Summary
Purpose: test purpose
Behavior: test behavior

## Correctness Review Checklist

Error Handling:
- Ignored errors (assigned to _ or not checked)
- Missing error wrapping (use fmt.Errorf with %w)
- Panic for recoverable errors
- Error shadowing in inner scopes

Nil and Bounds Safety:
- Nil pointer dereference without check
- Slice/array access without bounds check
- Map access assuming key exists when it might not
- Type assertions without ok check

Resource Management:
- Unclosed files, connections, or response bodies
- Missing defer for cleanup
- defer in loops (accumulates until function returns)
- Resources not released on error paths
- Context cancellation not checked in long operations
- Missing timeouts on network operations

Only report actual correctness bugs. If no issues found, return {"issues": []}.

Respond with JSON. The "code" field must contain the exact line of code where the issue occurs, copied verbatim from the code block above.

Example:
{"issues": [{"function": "ParseConfig", "code": "	query := \"SELECT * FROM users WHERE id=\" + id", "severity": "critical", "message": "SQL injection via string concatenation", "suggestion": "Use parameterized query"}]}

If no issues found, return {"issues": []}.
